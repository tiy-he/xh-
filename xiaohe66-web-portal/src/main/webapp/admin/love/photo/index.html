<!DOCTYPE html>
<html lang="en">
<head>
    <title></title>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="/admin/Css/bootstrap.css"/>
    <link rel="stylesheet" type="text/css" href="/admin/Css/bootstrap-responsive.css"/>
    <link rel="stylesheet" type="text/css" href="/admin/Css/style.css"/>
    <link rel="stylesheet" type="text/css" href="/plugin/xh/css/xh-paging.css"/>
    <link rel="stylesheet" type="text/css" href="/plugin/xh/css/xh-mask.css"/>
    <script type="text/javascript" src="/admin/Js/jquery.js"></script>
    <!--<script type="text/javascript" src="/admin/Js/jquery.sorted.js"></script>-->
    <script type="text/javascript" src="/admin/Js/bootstrap.js"></script>
    <script type="text/javascript" src="/admin/Js/ckform.js"></script>
    <script type="text/javascript" src="/admin/Js/common.js"></script>
    <script type="text/javascript" src="/plugin/xh/js/xh-common.js"></script>
    <script type="text/javascript" src="/plugin/xh/js/xh-mask.js"></script>
    <script type="text/javascript" src="/plugin/xh/js/xh-paging.js"></script>

    <style type="text/css">
        body {
            padding-bottom: 40px;
        }

        .sidebar-nav {
            padding: 9px 0;
        }

        @media (max-width: 980px) {
            /* Enable use of floated navbar text */
            .navbar-text.pull-right {
                float: none;
                padding-left: 5px;
                padding-right: 5px;
            }
        }

        .table td {
            height: 40px;
            vertical-align: middle;
            text-align: center;
        }

        .delete {
            margin-left: 10px;
        }

    </style>
</head>
<body>
<form class="form-inline definewidth m20">
    照片名称：
    <input id="photoName" type="text" name="rolename" class="abc input-default" placeholder="" value="">&nbsp;&nbsp;
    <button id="select" type="button" class="btn btn-primary">查询</button>&nbsp;&nbsp;
    <button type="button" class="btn btn-success" id="addnew">新增照片</button>
</form>
<table class="table table-bordered table-hover definewidth m10">
    <colgroup>
        <col width="150px">
        <col width="200px">
        <col>
        <col>
        <col>
        <col width="80px">
        <col width="80px">
    </colgroup>
    <thead>
    <tr>
        <th>缩略图</th>
        <th>照片名称</th>
        <th>第一段话</th>
        <th>第二段话</th>
        <th>第三段话</th>
        <th>状态</th>
        <th>管理操作</th>
    </tr>
    </thead>
    <tbody id="dataTbody">
    </tbody>
</table>
<div id="paging"></div>
</body>
</html>
<script>
    $(function () {

        $('#addnew').click(function () {
            location.href = "/admin/love/photo/edit.html";
        });

        $("#select").click(function () {
            loadData(1);
        });

        $(document).on("click", ".edit", function () {
            let id = $(this).parent().parent().attr("photoId");
            location.href = "/admin/love/photo/edit.html?id=" + id;
        });
        $(document).on("click", ".delete", function (message) {
            let id = $(this).parent().parent().attr("photoId");
            let isDelete = confirm("确定删除吗？");
            if (isDelete) {
                del("/love/photo/" + id, function (data) {
                    location.reload();
                });
            }
        });

        let pageSize = 10;
        let tbody = $("#dataTbody");
        let pages;
        var loadData = function (pageNo) {
            tbody.html("");
            $.hint("加载中");
            let photoName = $("#photoName").val();
            if (photoName && photoName.length > 6) {
                alert("搜索名称太长");
                return;
            }
            let url = "/love/photo";
            if (photoName) {
                url += "?name=" + photoName;
            }
            paging(url, pageNo, pageSize, function (data) {
                console.log(data);
                let list = data.records;
                if (list.length === 0) {
                    tbody.append("<tr><td colspan='7'>暂无数据</td></tr>");
                } else {
                    $.each(list, function (i, item) {
                        let html = "<tr photoId='" + item.id + "'>" +
                            "<td><img src='/love/photo/img/" + item.id + "' class='thumbnail' alt='" + item.name + "'></td>" +
                            "<td>" + item.name + "</td>" +
                            "<td>" + item.one + "</td>" +
                            "<td>" + (item.two ? item.two : "") + "</td>" +
                            "<td>" + (item.three ? item.three : "") + "</td>" +
                            "<td>" + (item.isShow ? "显示" : "不显示") + "</td>" +
                            "<td>" +
                            "<a class='edit' href='javascript:'>编辑</a>" +
                            "<a class='delete' href='javascript:'>删除</a>" +
                            "</td>" +
                            "</tr>";
                        tbody.append(html);
                    });
                }
                if (!pages) {
                    pages = data.pages;
                    $("#paging").paging(pages, 1, loadData);
                }
                $.hintClose();
            });
        };
        loadData(1);

    });
</script>